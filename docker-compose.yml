version: "3"

services:

  registry:
    restart: always
    image: registry.cn-hangzhou.aliyuncs.com/gosun/com.github.lzk90s.fttb.registry:1.0.0-SNAPSHOT
    environment:
      - PARAMS
    networks:
      - toolbox
    ports:
      - 29000:29000

  gateway:
    restart: always
    image: registry.cn-hangzhou.aliyuncs.com/gosun/com.github.lzk90s.fttb.gateway:1.0.0-SNAPSHOT
    environment:
      - PARAMS
    networks:
      - toolbox

  mysql:
    restart: always
    image: mariadb:10
    networks:
      - toolbox
    environment:
      - MYSQL_ROOT_PASSWORD
    volumes:
      - ./data/mysql:/var/lib/mysql
  #    ports:
  #      - 3306:3306

  dbbackup:
    restart: always
    image: registry.cn-hangzhou.aliyuncs.com/gosun/com.github.lzk90s.fttb.dbbackup:1.0.0-SNAPSHOT
    networks:
      - toolbox
    environment:
      - MYSQL_ROOT_PASSWORD
    depends_on:
      - mysql
    volumes:
      - ./data/dbbackup:/backup

  auth:
    restart: always
    image: registry.cn-hangzhou.aliyuncs.com/gosun/com.github.lzk90s.fttb.auth:1.0.0-SNAPSHOT
    networks:
      - toolbox
    depends_on:
      - mysql
    environment:
      - MYSQL_ROOT_PASSWORD
      - PARAMS

  trade:
    restart: always
    image: registry.cn-hangzhou.aliyuncs.com/gosun/com.github.lzk90s.fttb.trade:1.0.0-SNAPSHOT
    networks:
      - toolbox
    depends_on:
      - mysql
    environment:
      - MYSQL_ROOT_PASSWORD
      - PARAMS

  web:
    restart: always
    image: registry.cn-hangzhou.aliyuncs.com/gosun/com.github.lzk90s.fttb.web:1.0.0-SNAPSHOT
    networks:
      - toolbox
    ports:
      - 20080:80

networks:
  toolbox:
    driver: bridge
